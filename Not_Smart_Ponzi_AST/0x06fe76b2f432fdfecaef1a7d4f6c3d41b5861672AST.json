{"type": "SourceUnit", "children": [{"type": "PragmaDirective", "name": "solidity", "value": "0.6.5"}, {"type": "PragmaDirective", "name": "experimental", "value": "ABIEncoderV2"}, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, {"type": "ContractDefinition", "name": "Strings", "baseContracts": [], "subNodes": [{"type": "FunctionDefinition", "name": "isEmpty", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "s", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "bytes"}}, "arguments": [{"type": "Identifier", "name": "s"}], "names": []}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": "pure"}, {"type": "FunctionDefinition", "name": "isEqualTo", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "s1", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "s2", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "keccak256"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "abi"}, "memberName": "encodePacked"}, "arguments": [{"type": "Identifier", "name": "s1"}], "names": []}], "names": []}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "keccak256"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "abi"}, "memberName": "encodePacked"}, "arguments": [{"type": "Identifier", "name": "s2"}], "names": []}], "names": []}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": "pure"}], "kind": "library"}, {"type": "ContractDefinition", "name": "TokenAdapter", "baseContracts": [], "subNodes": [{"type": "FunctionDefinition", "name": "getMetadata", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "token", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "TokenMetadata"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getComponents", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "token", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "Component"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}], "kind": "interface"}, {"type": "ContractDefinition", "name": "ProtocolAdapter", "baseContracts": [], "subNodes": [{"type": "FunctionDefinition", "name": "adapterType", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "pure"}, {"type": "FunctionDefinition", "name": "tokenType", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "pure"}, {"type": "FunctionDefinition", "name": "getBalance", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "token", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "account", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}], "kind": "interface"}, null, {"type": "ContractDefinition", "name": "Ownable", "baseContracts": [], "subNodes": [{"type": "ModifierDefinition", "name": "onlyOwner", "parameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, "right": {"type": "Identifier", "name": "owner"}}, {"type": "StringLiteral", "value": "O: onlyOwner function!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "Identifier", "name": "_"}}]}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "owner", "expression": null, "visibility": "public", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "EventDefinition", "name": "OwnershipTransferred", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "previousOwner", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "newOwner", "isStateVar": false, "isIndexed": true}]}, "isAnonymous": false}, {"type": "FunctionDefinition", "name": null, "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": null, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "owner"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, {"type": "EmitStatement", "eventCall": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "OwnershipTransferred"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}], "names": []}}]}, "visibility": "internal", "modifiers": [], "isConstructor": true, "stateMutability": null}, {"type": "FunctionDefinition", "name": "transferOwnership", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "_owner", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "_owner"}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}, {"type": "StringLiteral", "value": "O: new owner is the zero address!"}], "names": []}}, {"type": "EmitStatement", "eventCall": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "OwnershipTransferred"}, "arguments": [{"type": "Identifier", "name": "owner"}, {"type": "Identifier", "name": "_owner"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "owner"}, "right": {"type": "Identifier", "name": "_owner"}}}]}, "visibility": "external", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}], "kind": "contract"}, null, {"type": "ContractDefinition", "name": "TokenAdapterManager", "baseContracts": [{"type": "InheritanceSpecifier", "baseName": {"type": "UserDefinedTypeName", "namePath": "Ownable"}, "arguments": []}], "subNodes": [{"type": "UsingForDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "libraryName": "Strings"}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "INITIAL_NAME", "expression": {"type": "StringLiteral", "value": "Initial token name"}, "visibility": "internal", "isStateVar": true, "isDeclaredConst": true, "isIndexed": false}], "initialValue": {"type": "StringLiteral", "value": "Initial token name"}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "string"}, "valueType": {"type": "ElementaryTypeName", "name": "string"}}, "name": "nextTokenAdapterName", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "string"}, "valueType": {"type": "ElementaryTypeName", "name": "address"}}, "name": "tokenAdapter", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "FunctionDefinition", "name": null, "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": null, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "INITIAL_NAME"}}, "right": {"type": "Identifier", "name": "INITIAL_NAME"}}}]}, "visibility": "internal", "modifiers": [], "isConstructor": true, "stateMutability": null}, {"type": "FunctionDefinition", "name": "addTokenAdapters", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "tokenAdapterNames", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "adapters", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "length", "storageLocation": null}], "initialValue": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterNames"}, "memberName": "length"}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "Identifier", "name": "length"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}}, {"type": "StringLiteral", "value": "TAM: lengths differ!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "Identifier", "name": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "addTokenAdapter"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapterNames"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeTokenAdapters", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "tokenAdapterNames", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterNames"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterNames"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "removeTokenAdapter"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapterNames"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "updateTokenAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenAdapterName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapter", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidTokenAdapter"}, "arguments": [{"type": "Identifier", "name": "tokenAdapterName"}], "names": []}, {"type": "StringLiteral", "value": "TAM: bad name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "adapter"}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}, {"type": "StringLiteral", "value": "TAM: zero!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapter"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "right": {"type": "Identifier", "name": "adapter"}}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "getTokenAdapterNames", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "counter", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "currentTokenAdapterName", "storageLocation": "memory"}], "initialValue": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "INITIAL_NAME"}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentTokenAdapterName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_NAME"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentTokenAdapterName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "currentTokenAdapterName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "tokenAdapters", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}}, "arguments": [{"type": "Identifier", "name": "counter"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "counter"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentTokenAdapterName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "INITIAL_NAME"}}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentTokenAdapterName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_NAME"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapters"}, "index": {"type": "Identifier", "name": "counter"}}, "right": {"type": "Identifier", "name": "currentTokenAdapterName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentTokenAdapterName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "currentTokenAdapterName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}}, {"type": "Identifier", "name": "tokenAdapters"}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getTokenAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenAdapterName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapter"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "isValidTokenAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenAdapterName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "BinaryOperation", "operator": "&&", "left": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "right": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_NAME"}], "names": []}, "isPrefix": true}}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "addTokenAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenAdapterName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapter", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_NAME"}], "names": []}, "isPrefix": true}, {"type": "StringLiteral", "value": "TAM: initial name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokenAdapterName"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, {"type": "StringLiteral", "value": "TAM: empty name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "memberName": "isEmpty"}, "arguments": [], "names": []}, {"type": "StringLiteral", "value": "TAM: name exists!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "adapter"}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}, {"type": "StringLiteral", "value": "TAM: zero!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "INITIAL_NAME"}}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "INITIAL_NAME"}}, "right": {"type": "Identifier", "name": "tokenAdapterName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapter"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "right": {"type": "Identifier", "name": "adapter"}}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeTokenAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenAdapterName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidTokenAdapter"}, "arguments": [{"type": "Identifier", "name": "tokenAdapterName"}], "names": []}, {"type": "StringLiteral", "value": "TAM: bad name!"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "prevTokenAdapterName", "storageLocation": "memory"}], "initialValue": null}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "currentTokenAdapterName", "storageLocation": "memory"}], "initialValue": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentTokenAdapterName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "tokenAdapterName"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "prevTokenAdapterName"}, "right": {"type": "Identifier", "name": "currentTokenAdapterName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentTokenAdapterName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "currentTokenAdapterName"}}}}]}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "prevTokenAdapterName"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextTokenAdapterName"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "isPrefix": true}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokenAdapter"}, "index": {"type": "Identifier", "name": "tokenAdapterName"}}, "isPrefix": true}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}], "kind": "contract"}, null, {"type": "ContractDefinition", "name": "ProtocolManager", "baseContracts": [{"type": "InheritanceSpecifier", "baseName": {"type": "UserDefinedTypeName", "namePath": "Ownable"}, "arguments": []}], "subNodes": [{"type": "UsingForDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "libraryName": "Strings"}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "INITIAL_PROTOCOL_NAME", "expression": {"type": "StringLiteral", "value": "Initial protocol name"}, "visibility": "internal", "isStateVar": true, "isDeclaredConst": true, "isIndexed": false}], "initialValue": {"type": "StringLiteral", "value": "Initial protocol name"}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "string"}, "valueType": {"type": "ElementaryTypeName", "name": "string"}}, "name": "nextProtocolName", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "string"}, "valueType": {"type": "UserDefinedTypeName", "namePath": "ProtocolMetadata"}}, "name": "protocolMetadata", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "string"}, "valueType": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}}, "name": "protocolAdapters", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "address"}, "valueType": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}}, "name": "supportedTokens", "expression": null, "visibility": "internal", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "FunctionDefinition", "name": null, "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": null, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}, "right": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}}]}, "visibility": "internal", "modifiers": [], "isConstructor": true, "stateMutability": null}, {"type": "FunctionDefinition", "name": "addProtocols", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "protocolNames", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolMetadata"}, "length": null}, "name": "metadata", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "length": null}, "name": "adapters", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "length": null}, "length": null}, "name": "tokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "length"}}, {"type": "StringLiteral", "value": "PM: protocolNames & metadata differ!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}}, {"type": "StringLiteral", "value": "PM: protocolNames & adapters differ!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokens"}, "memberName": "length"}}, {"type": "StringLiteral", "value": "PM: protocolNames & tokens differ!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "addProtocol"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolNames"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "metadata"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokens"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeProtocols", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "protocolNames", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "removeProtocol"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolNames"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "updateProtocolMetadata", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "name", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "description", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "websiteURL", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "iconURL", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidProtocol"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, {"type": "StringLiteral", "value": "PM: bad name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "abi"}, "memberName": "encodePacked"}, "arguments": [{"type": "Identifier", "name": "name"}, {"type": "Identifier", "name": "description"}, {"type": "Identifier", "name": "websiteURL"}, {"type": "Identifier", "name": "iconURL"}], "names": []}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolMetadata"}, "name": "metadata", "storageLocation": "storage"}], "initialValue": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}}, {"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "name"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "name"}, "right": {"type": "Identifier", "name": "name"}}}]}, "FalseBody": null}, {"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "description"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "description"}, "right": {"type": "Identifier", "name": "description"}}}]}, "FalseBody": null}, {"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "websiteURL"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "websiteURL"}, "right": {"type": "Identifier", "name": "websiteURL"}}}]}, "FalseBody": null}, {"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "iconURL"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "iconURL"}, "right": {"type": "Identifier", "name": "iconURL"}}}]}, "FalseBody": null}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "version"}, "isPrefix": false}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "addProtocolAdapters", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "adapters", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "length": null}, "name": "tokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidProtocol"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, {"type": "StringLiteral", "value": "PM: bad name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "addProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "protocolName"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokens"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "version"}, "isPrefix": false}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeProtocolAdapters", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "uint256"}, "length": null}, "name": "adapterIndices", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidProtocol"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, {"type": "StringLiteral", "value": "PM: bad name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapterIndices"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapterIndices"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "removeProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "protocolName"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapterIndices"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "version"}, "isPrefix": false}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "updateProtocolAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "index", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "newAdapterAddress", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "newSupportedTokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidProtocol"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, {"type": "StringLiteral", "value": "PM: bad name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "index"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "length"}}, {"type": "StringLiteral", "value": "PM: bad index!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "newAdapterAddress"}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}, {"type": "StringLiteral", "value": "PM: empty!"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapterAddress", "storageLocation": null}], "initialValue": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "index": {"type": "Identifier", "name": "index"}}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "==", "left": {"type": "Identifier", "name": "newAdapterAddress"}, "right": {"type": "Identifier", "name": "adapterAddress"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "adapterAddress"}}, "right": {"type": "Identifier", "name": "newSupportedTokens"}}}]}, "FalseBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "index": {"type": "Identifier", "name": "index"}}, "right": {"type": "Identifier", "name": "newAdapterAddress"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "newAdapterAddress"}}, "right": {"type": "Identifier", "name": "newSupportedTokens"}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "adapterAddress"}}, "isPrefix": true}}]}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "version"}, "isPrefix": false}}]}, "visibility": "public", "modifiers": [{"type": "ModifierInvocation", "name": "onlyOwner", "arguments": []}], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "getProtocolNames", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "counter", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "currentProtocolName", "storageLocation": "memory"}], "initialValue": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentProtocolName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentProtocolName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "currentProtocolName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "protocols", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}}, "arguments": [{"type": "Identifier", "name": "counter"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "counter"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentProtocolName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentProtocolName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocols"}, "index": {"type": "Identifier", "name": "counter"}}, "right": {"type": "Identifier", "name": "currentProtocolName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentProtocolName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "currentProtocolName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}}, {"type": "Identifier", "name": "protocols"}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getProtocolMetadata", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolMetadata"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "TupleExpression", "components": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}], "isArray": false}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getProtocolAdapters", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getSupportedTokens", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapter", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "adapter"}}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "isValidProtocol", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "BinaryOperation", "operator": "&&", "left": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, "right": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}], "names": []}, "isPrefix": true}}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "addProtocol", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolMetadata"}, "name": "metadata", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "adapters", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "length": null}, "name": "tokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}], "names": []}, "isPrefix": true}, {"type": "StringLiteral", "value": "PM: initial name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolName"}, "memberName": "isEmpty"}, "arguments": [], "names": []}, "isPrefix": true}, {"type": "StringLiteral", "value": "PM: empty name!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "isEmpty"}, "arguments": [], "names": []}, {"type": "StringLiteral", "value": "PM: name exists!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokens"}, "memberName": "length"}}, {"type": "StringLiteral", "value": "PM: adapters & tokens differ!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "INITIAL_PROTOCOL_NAME"}}, "right": {"type": "Identifier", "name": "protocolName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "ProtocolMetadata"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "name"}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "description"}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "websiteURL"}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "iconURL"}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "metadata"}, "memberName": "version"}], "names": ["name", "description", "websiteURL", "iconURL", "version"]}}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "addProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "protocolName"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokens"}, "index": {"type": "Identifier", "name": "i"}}], "names": []}}]}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeProtocol", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "isValidProtocol"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, {"type": "StringLiteral", "value": "PM: bad name!"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "prevProtocolName", "storageLocation": "memory"}], "initialValue": null}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "currentProtocolName", "storageLocation": "memory"}], "initialValue": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}}, {"type": "WhileStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "currentProtocolName"}, "memberName": "isEqualTo"}, "arguments": [{"type": "Identifier", "name": "protocolName"}], "names": []}, "isPrefix": true}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "prevProtocolName"}, "right": {"type": "Identifier", "name": "currentProtocolName"}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentProtocolName"}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "currentProtocolName"}}}}]}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "Identifier", "name": "protocolName"}}, "isPrefix": true}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "prevProtocolName"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nextProtocolName"}, "index": {"type": "Identifier", "name": "protocolName"}}, "isPrefix": true}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "length", "storageLocation": null}], "initialValue": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "length"}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "length"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "Identifier", "name": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "--", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "removeProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "protocolName"}, {"type": "Identifier", "name": "i"}], "names": []}}]}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "addProtocolAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapter", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "tokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "adapter"}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}, {"type": "StringLiteral", "value": "PM: zero!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "adapter"}}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StringLiteral", "value": "PM: exists!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "push"}, "arguments": [{"type": "Identifier", "name": "adapter"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "Identifier", "name": "adapter"}}, "right": {"type": "Identifier", "name": "tokens"}}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "removeProtocolAdapter", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "protocolName", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "index", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "length", "storageLocation": null}], "initialValue": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "length"}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "index"}, "right": {"type": "Identifier", "name": "length"}}, {"type": "StringLiteral", "value": "PM: bad index!"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "delete", "subExpression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "index": {"type": "Identifier", "name": "index"}}}, "isPrefix": true}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "!=", "left": {"type": "Identifier", "name": "index"}, "right": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "length"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "index": {"type": "Identifier", "name": "index"}}, "right": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "index": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "length"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}}}]}, "FalseBody": null}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "Identifier", "name": "protocolName"}}, "memberName": "pop"}, "arguments": [], "names": []}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}], "kind": "contract"}, {"type": "ContractDefinition", "name": "AdapterRegistry", "baseContracts": [{"type": "InheritanceSpecifier", "baseName": {"type": "UserDefinedTypeName", "namePath": "Ownable"}, "arguments": []}, {"type": "InheritanceSpecifier", "baseName": {"type": "UserDefinedTypeName", "namePath": "ProtocolManager"}, "arguments": []}, {"type": "InheritanceSpecifier", "baseName": {"type": "UserDefinedTypeName", "namePath": "TokenAdapterManager"}, "arguments": []}], "subNodes": [{"type": "UsingForDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "libraryName": "Strings"}, {"type": "FunctionDefinition", "name": "getFullTokenBalance", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenType", "storageLocation": "calldata", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "token", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "FullTokenBalance"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "Component"}, "length": null}, "name": "components", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getComponents"}, "arguments": [{"type": "Identifier", "name": "tokenType"}, {"type": "Identifier", "name": "token"}, {"type": "NumberLiteral", "number": "1e18", "subdenomination": null}], "names": []}}, {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFullTokenBalance"}, "arguments": [{"type": "Identifier", "name": "tokenType"}, {"type": "Identifier", "name": "token"}, {"type": "NumberLiteral", "number": "1e18", "subdenomination": null}, {"type": "Identifier", "name": "components"}], "names": []}]}, "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getFinalFullTokenBalance", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenType", "storageLocation": "calldata", "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "token", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "FullTokenBalance"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "Component"}, "length": null}, "name": "finalComponents", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFinalComponents"}, "arguments": [{"type": "Identifier", "name": "tokenType"}, {"type": "Identifier", "name": "token"}, {"type": "NumberLiteral", "number": "1e18", "subdenomination": null}], "names": []}}, {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFullTokenBalance"}, "arguments": [{"type": "Identifier", "name": "tokenType"}, {"type": "Identifier", "name": "token"}, {"type": "NumberLiteral", "number": "1e18", "subdenomination": null}, {"type": "Identifier", "name": "finalComponents"}], "names": []}]}, "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getBalances", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "account", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "protocolNames", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getProtocolNames"}, "arguments": [], "names": []}}, {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getProtocolBalances"}, "arguments": [{"type": "Identifier", "name": "account"}, {"type": "Identifier", "name": "protocolNames"}], "names": []}]}, "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getProtocolBalances", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "account", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "string"}, "length": null}, "name": "protocolNames", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}, "name": "protocolBalances", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}}, "arguments": [{"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "counter", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolBalances"}, "index": {"type": "Identifier", "name": "i"}}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "ProtocolBalance"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolMetadata"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolNames"}, "index": {"type": "Identifier", "name": "i"}}}, {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getAdapterBalances"}, "arguments": [{"type": "Identifier", "name": "account"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolAdapters"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolNames"}, "index": {"type": "Identifier", "name": "i"}}}], "names": []}], "names": ["metadata", "adapterBalances"]}}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolBalances"}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "adapterBalances"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}, "name": "nonZeroProtocolBalances", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "ProtocolBalance"}, "length": null}}, "arguments": [{"type": "Identifier", "name": "counter"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "counter"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "protocolNames"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolBalances"}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "adapterBalances"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nonZeroProtocolBalances"}, "index": {"type": "Identifier", "name": "counter"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "protocolBalances"}, "index": {"type": "Identifier", "name": "i"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "Identifier", "name": "nonZeroProtocolBalances"}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getAdapterBalances", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "account", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "adapters", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "length": null}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "length": null}, "name": "adapterBalances", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "length": null}}, "arguments": [{"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapters"}, "memberName": "length"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "counter", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapterBalances"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapterBalances"}, "index": {"type": "Identifier", "name": "i"}}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getAdapterBalance"}, "arguments": [{"type": "Identifier", "name": "account"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "supportedTokens"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapters"}, "index": {"type": "Identifier", "name": "i"}}}], "names": []}}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapterBalances"}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "balances"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "length": null}, "name": "nonZeroAdapterBalances", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "length": null}}, "arguments": [{"type": "Identifier", "name": "counter"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "counter"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "adapterBalances"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapterBalances"}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "balances"}, "memberName": "length"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "nonZeroAdapterBalances"}, "index": {"type": "Identifier", "name": "counter"}}, "right": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "adapterBalances"}, "index": {"type": "Identifier", "name": "i"}}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "counter"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "Identifier", "name": "nonZeroAdapterBalances"}]}, "visibility": "public", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "getAdapterBalance", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "account", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "adapter", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "address"}, "length": null}, "name": "tokens", "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "UserDefinedTypeName", "namePath": "AdapterBalance"}, "name": null, "storageLocation": "memory", "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "string"}, "name": "tokenType", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "ProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "adapter"}], "names": []}, "memberName": "tokenType"}, "arguments": [], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "uint256"}, "length": null}, "name": "amounts", "storageLocation": "memory"}], "initialValue": {"type": "FunctionCall", "expression": {"type": "NewExpression", "typeName": {"type": "ArrayTypeName", "baseTypeName": {"type": "ElementaryTypeName", "name": "uint256"}, "length": null}}, "arguments": [{"type": "MemberAccess", "expression": {"type": "Identifier", "name": "tokens"}, "memberName": "length"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "counter", "storageLocation": null}], "initialValue": null}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "amounts"}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "ProtocolAdapter"}, "arguments": [{"type": "Identifier", "name": "adapter"}], "names": []}, "memberName": "getBalance"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "tokens"}, "index": {"type": "Identifier", "name": "i"}}, {"type": "Identifier", "name": "account"}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "name": "result", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "isStateVar": false, "isIndexed": false, "decl": 