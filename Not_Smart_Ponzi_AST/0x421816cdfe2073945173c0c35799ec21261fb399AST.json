{"type": "SourceUnit", "children": [{"type": "PragmaDirective", "name": "solidity", "value": "0.5.16"}, {"type": "ContractDefinition", "name": "IERC20", "baseContracts": [], "subNodes": [{"type": "FunctionDefinition", "name": "transfer", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "approve", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "balanceOf", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}, {"type": "FunctionDefinition", "name": "allowance", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": [], "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "view"}], "kind": "interface"}, {"type": "ContractDefinition", "name": "EthToDaiTradeHelperV3", "baseContracts": [], "subNodes": [{"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "UserDefinedTypeName", "namePath": "IERC20"}, "name": "_DAI", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "IERC20"}, "arguments": [{"type": "NumberLiteral", "number": "0x6B175474E89094C44Da98b954EedeAC495271d0F", "subdenomination": null}], "names": []}, "visibility": "internal", "isStateVar": true, "isDeclaredConst": true, "isIndexed": false}], "initialValue": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "IERC20"}, "arguments": [{"type": "NumberLiteral", "number": "0x6B175474E89094C44Da98b954EedeAC495271d0F", "subdenomination": null}], "names": []}}, {"type": "FunctionDefinition", "name": "tradeEthForDai", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "daiExpected", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address", "stateMutability": "payable"}, "name": "target", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bytes"}, "name": "data", "storageLocation": "calldata", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "daiReceived", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": null, "initialValue": {"type": "FunctionCall", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "target"}, "memberName": "call"}, "memberName": "value"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "Identifier", "name": "this"}], "names": []}, "memberName": "balance"}], "names": []}, "arguments": [{"type": "Identifier", "name": "data"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "_revertOnFailure"}, "arguments": [{"type": "Identifier", "name": "ok"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "daiReceived"}, "right": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "_DAI"}, "memberName": "balanceOf"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "Identifier", "name": "this"}], "names": []}], "names": []}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "Identifier", "name": "daiReceived"}, "right": {"type": "Identifier", "name": "daiExpected"}}, {"type": "StringLiteral", "value": "Trade did not result in the expected amount of Dai."}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "ok"}, "right": {"type": "TupleExpression", "components": [{"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "_DAI"}, "memberName": "transfer"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, {"type": "Identifier", "name": "daiReceived"}], "names": []}], "isArray": false}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "Identifier", "name": "ok"}, {"type": "StringLiteral", "value": "Dai transfer out failed."}], "names": []}}]}, "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": "payable"}, {"type": "FunctionDefinition", "name": "tradeDaiForEth", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "ethExpected", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "target", "storageLocation": null, "isStateVar": false, "isIndexed": false}, {"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bytes"}, "name": "data", "storageLocation": "calldata", "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "ethReceived", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "!=", "left": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "_DAI"}, "memberName": "allowance"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "Identifier", "name": "this"}], "names": []}, {"type": "Identifier", "name": "target"}], "names": []}, "right": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}}, "arguments": [{"type": "UnaryOperation", "operator": "-", "subExpression": {"type": "NumberLiteral", "number": "1", "subdenomination": null}, "isPrefix": true}], "names": []}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "_DAI"}, "memberName": "approve"}, "arguments": [{"type": "Identifier", "name": "target"}, {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}}, "arguments": [{"type": "UnaryOperation", "operator": "-", "subExpression": {"type": "NumberLiteral", "number": "1", "subdenomination": null}, "isPrefix": true}], "names": []}], "names": []}}]}, "FalseBody": null}, {"type": "VariableDeclarationStatement", "variables": null, "initialValue": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "target"}, "memberName": "call"}, "arguments": [{"type": "Identifier", "name": "data"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "_revertOnFailure"}, "arguments": [{"type": "Identifier", "name": "ok"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "ethReceived"}, "right": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "ElementaryTypeNameExpression", "typeName": {"type": "ElementaryTypeName", "name": "address"}}, "arguments": [{"type": "Identifier", "name": "this"}], "names": []}, "memberName": "balance"}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "require"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "Identifier", "name": "ethReceived"}, "right": {"type": "Identifier", "name": "ethExpected"}}, {"type": "StringLiteral", "value": "Trade did not result in the expected amount of Ether."}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "TupleExpression", "components": [{"type": "Identifier", "name": "ok"}, null], "isArray": false}, "right": {"type": "FunctionCall", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, "memberName": "call"}, "memberName": "gas"}, "arguments": [{"type": "NumberLiteral", "number": "4999", "subdenomination": null}], "names": []}, "memberName": "value"}, "arguments": [{"type": "Identifier", "name": "ethReceived"}], "names": []}, "arguments": [{"type": "StringLiteral", "value": ""}], "names": []}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "_revertOnFailure"}, "arguments": [{"type": "Identifier", "name": "ok"}], "names": []}}]}, "visibility": "external", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "_revertOnFailure", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": "ok", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "Identifier", "name": "ok"}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "InLineAssemblyStatement", "language": null, "body": {"type": "AssemblyBlock", "operations": [{"type": "AssemblyExpression", "functionName": "returndatacopy", "arguments": [{"type": "DecimalNumber", "value": "0"}, {"type": "DecimalNumber", "value": "0"}, {"type": "AssemblyExpression", "functionName": "returndatasize", "arguments": []}]}, {"type": "AssemblyExpression", "functionName": "revert", "arguments": [{"type": "DecimalNumber", "value": "0"}, {"type": "AssemblyExpression", "functionName": "returndatasize", "arguments": []}]}]}}]}, "FalseBody": null}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": "pure"}], "kind": "contract"}]}