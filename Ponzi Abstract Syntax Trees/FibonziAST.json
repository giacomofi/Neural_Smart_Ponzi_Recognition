{"type": "SourceUnit", "children": [{"type": "PragmaDirective", "name": "solidity", "value": "^0.4.15"}, {"type": "ContractDefinition", "name": "Fibonzi", "baseContracts": [], "subNodes": [{"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "owner", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolCount", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerCount", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolJoinedCount", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "fiboIndex", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "poolToCreate", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenCount", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenUsed", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "fiboMax", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenToReward", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "currentShare", "expression": {"type": "NumberLiteral", "number": "0", "subdenomination": null}, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "StructDefinition", "name": "Player", "members": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "wallet", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "playerBalance", "storageLocation": null}]}, {"type": "StructDefinition", "name": "Pool", "members": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "price", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "owner", "storageLocation": null}]}, {"type": "StructDefinition", "name": "Token", "members": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenId", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "storageLocation": null}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": "used", "storageLocation": null}]}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "uint8"}, "valueType": {"type": "UserDefinedTypeName", "namePath": "Player"}}, "name": "players", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "uint8"}, "valueType": {"type": "UserDefinedTypeName", "namePath": "Pool"}}, "name": "pools", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "address"}, "valueType": {"type": "ElementaryTypeName", "name": "uint8"}}, "name": "playersWallets", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "address"}, "valueType": {"type": "ArrayTypeName", "baseTypeName": {"type": "UserDefinedTypeName", "namePath": "Token"}, "length": null}}, "name": "playersToken", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "StateVariableDeclaration", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "Mapping", "keyType": {"type": "ElementaryTypeName", "name": "address"}, "valueType": {"type": "ElementaryTypeName", "name": "uint"}}, "name": "playersBalance", "expression": null, "visibility": "default", "isStateVar": true, "isDeclaredConst": false, "isIndexed": false}], "initialValue": null}, {"type": "EventDefinition", "name": "PlayerCreated", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "address"}, "name": "wallet", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "timestamp", "isStateVar": false, "isIndexed": false}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "PlayerBalance", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "playerBalance", "isStateVar": false, "isIndexed": false}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "timestamp", "isStateVar": false, "isIndexed": false}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "PoolCreated", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "price", "isStateVar": false, "isIndexed": false}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "timestamp", "isStateVar": false, "isIndexed": false}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "PoolJoined", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": "price", "isStateVar": false, "isIndexed": false}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "timestamp", "isStateVar": false, "isIndexed": false}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "PoolPrize", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "prize", "isStateVar": false, "isIndexed": false}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "timestamp", "isStateVar": false, "isIndexed": false}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "TokenCreated", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}]}, "isAnonymous": false}, {"type": "EventDefinition", "name": "TokenUsed", "parameters": {"type": "ParameterList", "parameters": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "tokenId", "isStateVar": false, "isIndexed": true}, {"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "playerId", "isStateVar": false, "isIndexed": true}]}, "isAnonymous": false}, {"type": "FunctionDefinition", "name": "Fibonzi", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "owner"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPlayer"}, "arguments": [], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPool"}, "arguments": [], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "fiboIndex"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "fiboMax"}, "right": {"type": "NumberLiteral", "number": "18", "subdenomination": null}}}]}, "visibility": "default", "modifiers": [], "isConstructor": true, "stateMutability": null}, {"type": "FunctionDefinition", "name": "openPool", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "Identifier", "name": "poolCount"}, "right": {"type": "Identifier", "name": "poolId"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getPlayerUsableTokensCount"}, "arguments": [], "names": []}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "usePlayerToken"}, "arguments": [], "names": []}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "var"}, "name": "price", "storageLocation": null}], "initialValue": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "owner"}, "memberName": "transfer"}, "arguments": [{"type": "Identifier", "name": "price"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PoolPrize"}, "arguments": [{"type": "Identifier", "name": "poolId"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, {"type": "BinaryOperation", "operator": "*", "left": {"type": "NumberLiteral", "number": "2", "subdenomination": null}, "right": {"type": "Identifier", "name": "price"}}, {"type": "Identifier", "name": "now"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}, "memberName": "transfer"}, "arguments": [{"type": "BinaryOperation", "operator": "-", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}], "names": []}}]}, "FalseBody": null}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}, "right": {"type": "BinaryOperation", "operator": "*", "left": {"type": "NumberLiteral", "number": "2", "subdenomination": null}, "right": {"type": "Identifier", "name": "price"}}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PoolJoined"}, "arguments": [{"type": "Identifier", "name": "poolId"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}, {"type": "Identifier", "name": "now"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "poolJoinedCount"}, "isPrefix": false}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "<=", "left": {"type": "Identifier", "name": "fiboIndex"}, "right": {"type": "Identifier", "name": "fiboMax"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPoolIfNeeded"}, "arguments": [], "names": []}}]}, "FalseBody": null}]}, "visibility": "default", "modifiers": [], "isConstructor": false, "stateMutability": "payable"}, {"type": "FunctionDefinition", "name": "joinPool", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "poolId", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "Identifier", "name": "poolCount"}, "right": {"type": "Identifier", "name": "poolId"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">=", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": "||", "left": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "&&", "left": {"type": "BinaryOperation", "operator": "==", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, "right": {"type": "Identifier", "name": "owner"}}, "right": {"type": "BinaryOperation", "operator": "==", "left": {"type": "Identifier", "name": "poolCount"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}], "isArray": false}, "right": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "memberName": "playerId"}}], "isArray": false}}], "names": []}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "price", "storageLocation": null}], "initialValue": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}}, "memberName": "wallet"}, "memberName": "transfer"}, "arguments": [{"type": "BinaryOperation", "operator": "/", "left": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "*", "left": {"type": "Identifier", "name": "price"}, "right": {"type": "NumberLiteral", "number": "80", "subdenomination": null}}], "isArray": false}, "right": {"type": "NumberLiteral", "number": "100", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "distributeReward"}, "arguments": [{"type": "Identifier", "name": "price"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PoolPrize"}, "arguments": [{"type": "Identifier", "name": "poolId"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, {"type": "BinaryOperation", "operator": "*", "left": {"type": "NumberLiteral", "number": "2", "subdenomination": null}, "right": {"type": "Identifier", "name": "price"}}, {"type": "Identifier", "name": "now"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "owner"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}, "memberName": "transfer"}, "arguments": [{"type": "BinaryOperation", "operator": "-", "left": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "value"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}}], "names": []}}]}, "FalseBody": null}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}, "right": {"type": "BinaryOperation", "operator": "*", "left": {"type": "NumberLiteral", "number": "2", "subdenomination": null}, "right": {"type": "Identifier", "name": "price"}}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PoolJoined"}, "arguments": [{"type": "Identifier", "name": "poolId"}, {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolId"}}, "memberName": "price"}, {"type": "Identifier", "name": "now"}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "poolJoinedCount"}, "isPrefix": false}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "<=", "left": {"type": "Identifier", "name": "fiboIndex"}, "right": {"type": "Identifier", "name": "fiboMax"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPoolIfNeeded"}, "arguments": [], "names": []}}]}, "FalseBody": null}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPlayerToken"}, "arguments": [], "names": []}}]}, "visibility": "default", "modifiers": [], "isConstructor": false, "stateMutability": "payable"}, {"type": "FunctionDefinition", "name": "distributeReward", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "price", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "tokenCount"}, "right": {"type": "Identifier", "name": "tokenUsed"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "tokenToReward"}, "right": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "tokenCount"}, "right": {"type": "Identifier", "name": "tokenUsed"}}}}, {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "share", "storageLocation": null}], "initialValue": {"type": "BinaryOperation", "operator": "/", "left": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "/", "left": {"type": "BinaryOperation", "operator": "*", "left": {"type": "Identifier", "name": "price"}, "right": {"type": "NumberLiteral", "number": "20", "subdenomination": null}}, "right": {"type": "NumberLiteral", "number": "100", "subdenomination": null}}], "isArray": false}, "right": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "tokenCount"}, "right": {"type": "Identifier", "name": "tokenUsed"}}], "isArray": false}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "currentShare"}, "right": {"type": "Identifier", "name": "share"}}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "Identifier", "name": "playerCount"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "count", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "j", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "j"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "wallet"}}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "j"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "wallet"}}, "index": {"type": "Identifier", "name": "j"}}, "memberName": "used"}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "count"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "Identifier", "name": "count"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "+=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "playerBalance"}, "right": {"type": "BinaryOperation", "operator": "*", "left": {"type": "Identifier", "name": "share"}, "right": {"type": "Identifier", "name": "count"}}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersBalance"}, "index": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "wallet"}}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "playerBalance"}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PlayerBalance"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "playerId"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "playerBalance"}, {"type": "Identifier", "name": "now"}], "names": []}}]}, "FalseBody": null}]}}]}, "FalseBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "+=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerBalance"}, "right": {"type": "TupleExpression", "components": [{"type": "BinaryOperation", "operator": "/", "left": {"type": "BinaryOperation", "operator": "*", "left": {"type": "Identifier", "name": "price"}, "right": {"type": "NumberLiteral", "number": "20", "subdenomination": null}}, "right": {"type": "NumberLiteral", "number": "100", "subdenomination": null}}], "isArray": false}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersBalance"}, "index": {"type": "Identifier", "name": "owner"}}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerBalance"}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PlayerBalance"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerId"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerBalance"}, {"type": "Identifier", "name": "now"}], "names": []}}]}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "withdraw", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getPlayerUsableTokensCount"}, "arguments": [], "names": []}, "right": {"type": "NumberLiteral", "number": "10", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": ">", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersBalance"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}, "memberName": "transfer"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersBalance"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}], "names": []}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "10", "subdenomination": null}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "usePlayerToken"}, "arguments": [], "names": []}}]}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerBalance"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersBalance"}, "index": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "wallet"}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PlayerBalance"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}, {"type": "NumberLiteral", "number": "0", "subdenomination": null}, {"type": "Identifier", "name": "now"}], "names": []}}]}, "visibility": "default", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "createPool", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "poolCount"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "pools"}, "index": {"type": "Identifier", "name": "poolCount"}}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "Pool"}, "arguments": [{"type": "Identifier", "name": "poolCount"}, {"type": "NumberLiteral", "number": "1e16", "subdenomination": null}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}, "memberName": "playerId"}], "names": []}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PoolCreated"}, "arguments": [{"type": "Identifier", "name": "poolCount"}, {"type": "NumberLiteral", "number": "1e16", "subdenomination": null}, {"type": "Identifier", "name": "now"}], "names": []}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "createPlayer", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint256"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "Identifier", "name": "playerCount"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "assert"}, "arguments": [{"type": "BinaryOperation", "operator": "!=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "BinaryOperation", "operator": "+", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}}, "memberName": "wallet"}, "right": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}], "names": []}}]}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "playerCount"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "Identifier", "name": "playerCount"}}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "Player"}, "arguments": [{"type": "Identifier", "name": "playerCount"}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, {"type": "NumberLiteral", "number": "0", "subdenomination": null}], "names": []}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "right": {"type": "Identifier", "name": "playerCount"}}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "PlayerCreated"}, "arguments": [{"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}, {"type": "Identifier", "name": "now"}], "names": []}}, {"type": "Identifier", "name": "playerCount"}]}, "visibility": "default", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "createPoolIfNeeded", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "var"}, "name": "currentFibo", "storageLocation": null}], "initialValue": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFibo"}, "arguments": [{"type": "Identifier", "name": "fiboIndex"}], "names": []}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "Identifier", "name": "poolJoinedCount"}, "right": {"type": "Identifier", "name": "currentFibo"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "fiboIndex"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPoolIfNeeded"}, "arguments": [], "names": []}}]}, "FalseBody": {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "==", "left": {"type": "Identifier", "name": "poolJoinedCount"}, "right": {"type": "Identifier", "name": "currentFibo"}}, "TrueBody": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": ">", "left": {"type": "Identifier", "name": "currentFibo"}, "right": {"type": "Identifier", "name": "poolCount"}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "poolToCreate"}, "right": {"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "currentFibo"}, "right": {"type": "Identifier", "name": "poolCount"}}}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "Identifier", "name": "poolToCreate"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPool"}, "arguments": [], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "createPlayerToken"}, "arguments": [], "names": []}}]}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "poolToCreate"}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}}]}, "FalseBody": null}]}, "FalseBody": null}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "createPlayerToken", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": [], "body": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "tokenCount"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "memberName": "push"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "Token"}, "arguments": [{"type": "Identifier", "name": "tokenCount"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}, {"type": "BooleanLiteral", "value": false}], "names": []}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "TokenCreated"}, "arguments": [{"type": "Identifier", "name": "tokenCount"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}}, "memberName": "playerId"}], "names": []}}, {"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "==", "left": {"type": "BinaryOperation", "operator": "%", "left": {"type": "Identifier", "name": "tokenCount"}, "right": {"type": "NumberLiteral", "number": "9", "subdenomination": null}}, "right": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "tokenCount"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "Identifier", "name": "owner"}}, "memberName": "push"}, "arguments": [{"type": "FunctionCall", "expression": {"type": "Identifier", "name": "Token"}, "arguments": [{"type": "Identifier", "name": "tokenCount"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerId"}, {"type": "BooleanLiteral", "value": false}], "names": []}], "names": []}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "TokenCreated"}, "arguments": [{"type": "Identifier", "name": "tokenCount"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "players"}, "index": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersWallets"}, "index": {"type": "Identifier", "name": "owner"}}}, "memberName": "playerId"}], "names": []}}]}, "FalseBody": null}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "getFibo", "parameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": "n", "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "<=", "left": {"type": "Identifier", "name": "n"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}, "TrueBody": {"type": "Block", "statements": [{"type": "Identifier", "name": "n"}]}, "FalseBody": {"type": "Block", "statements": [{"type": "BinaryOperation", "operator": "+", "left": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFibo"}, "arguments": [{"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "n"}, "right": {"type": "NumberLiteral", "number": "1", "subdenomination": null}}], "names": []}, "right": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "getFibo"}, "arguments": [{"type": "BinaryOperation", "operator": "-", "left": {"type": "Identifier", "name": "n"}, "right": {"type": "NumberLiteral", "number": "2", "subdenomination": null}}], "names": []}}]}}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "getPlayerUsableTokensCount", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "count", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "used"}, "isPrefix": true}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "count"}, "isPrefix": false}}]}, "FalseBody": null}]}}, {"type": "Identifier", "name": "count"}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}, {"type": "FunctionDefinition", "name": "usePlayerToken", "parameters": {"type": "ParameterList", "parameters": []}, "returnParameters": {"type": "ParameterList", "parameters": [{"type": "Parameter", "typeName": {"type": "ElementaryTypeName", "name": "bool"}, "name": null, "storageLocation": null, "isStateVar": false, "isIndexed": false}]}, "body": {"type": "Block", "statements": [{"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "var"}, "name": "used", "storageLocation": null}], "initialValue": {"type": "BooleanLiteral", "value": false}}, {"type": "ForStatement", "initExpression": {"type": "VariableDeclarationStatement", "variables": [{"type": "VariableDeclaration", "typeName": {"type": "ElementaryTypeName", "name": "uint8"}, "name": "i", "storageLocation": null}], "initialValue": {"type": "NumberLiteral", "number": "0", "subdenomination": null}}, "conditionExpression": {"type": "BinaryOperation", "operator": "<", "left": {"type": "Identifier", "name": "i"}, "right": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "memberName": "length"}}, "loopExpression": {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "i"}, "isPrefix": false}}, "body": {"type": "Block", "statements": [{"type": "IfStatement", "condition": {"type": "BinaryOperation", "operator": "&&", "left": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "used"}, "isPrefix": true}, "right": {"type": "UnaryOperation", "operator": "!", "subExpression": {"type": "Identifier", "name": "used"}, "isPrefix": true}}, "TrueBody": {"type": "Block", "statements": [{"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "used"}, "right": {"type": "BooleanLiteral", "value": true}}}, {"type": "ExpressionStatement", "expression": {"type": "BinaryOperation", "operator": "=", "left": {"type": "Identifier", "name": "used"}, "right": {"type": "BooleanLiteral", "value": true}}}, {"type": "ExpressionStatement", "expression": {"type": "UnaryOperation", "operator": "++", "subExpression": {"type": "Identifier", "name": "tokenUsed"}, "isPrefix": false}}, {"type": "ExpressionStatement", "expression": {"type": "FunctionCall", "expression": {"type": "Identifier", "name": "TokenUsed"}, "arguments": [{"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "tokenId"}, {"type": "MemberAccess", "expression": {"type": "IndexAccess", "base": {"type": "IndexAccess", "base": {"type": "Identifier", "name": "playersToken"}, "index": {"type": "MemberAccess", "expression": {"type": "Identifier", "name": "msg"}, "memberName": "sender"}}, "index": {"type": "Identifier", "name": "i"}}, "memberName": "playerId"}], "names": []}}]}, "FalseBody": null}]}}, {"type": "Identifier", "name": "used"}]}, "visibility": "internal", "modifiers": [], "isConstructor": false, "stateMutability": null}], "kind": "contract"}]}